'use client';import {useEffect,useState} from 'react';type Row={id:string;sku:string;name:string;unit:string;stock_qty:number;priceA?:number;priceB?:number;priceC?:number};export default function AdminProducts(){const [list,setList]=useState<Row[]>([]);const [form,setForm]=useState<Row>({id:'',sku:'',name:'',unit:'τεμ.',stock_qty:0});async function load(){const full=await (await fetch('/api/admin/products')).json();setList(full);}useEffect(()=>{load();},[]);function exists(id:string){return !!list.find(x=>x.id===id);}async function submit(e:any){e.preventDefault();const method=exists(form.id)?'PUT':'POST';const res=await fetch('/api/products',{method,headers:{'Content-Type':'application/json'},body:JSON.stringify(form)});if(!res.ok){alert('Σφάλμα');return;}setForm({id:'',sku:'',name:'',unit:'τεμ.',stock_qty:0});await load();}function edit(p:any){setForm(p);}return(<div className='container py-8 space-y-6'><a className='btn' href='/'>← Επιστροφή</a><h1 className='text-2xl font-semibold'>Admin — Προϊόντα</h1><form onSubmit={submit} className='card'><div className='card-bd grid grid-cols-1 md:grid-cols-6 gap-3'><input className='input' placeholder='id' value={form.id} onChange={e=>setForm({...form,id:e.target.value})} required/><input className='input' placeholder='SKU' value={form.sku} onChange={e=>setForm({...form,sku:e.target.value})} required/><input className='input md:col-span-2' placeholder='Όνομα' value={form.name} onChange={e=>setForm({...form,name:e.target.value})} required/><input className='input' placeholder='Μονάδα' value={form.unit} onChange={e=>setForm({...form,unit:e.target.value})}/><input className='input' type='number' placeholder='Απόθεμα' value={form.stock_qty} onChange={e=>setForm({...form,stock_qty:Number(e.target.value)})}/><input className='input' type='number' step='0.01' placeholder='Τιμή A' value={form.priceA||''} onChange={e=>setForm({...form,priceA:Number(e.target.value)})}/><input className='input' type='number' step='0.01' placeholder='Τιμή B' value={form.priceB||''} onChange={e=>setForm({...form,priceB:Number(e.target.value)})}/><input className='input' type='number' step='0.01' placeholder='Τιμή C' value={form.priceC||''} onChange={e=>setForm({...form,priceC:Number(e.target.value)})}/><button className='btn btn-primary' type='submit'>{exists(form.id)?'Αποθήκευση':'Δημιουργία'}</button></div></form><div className='card'><div className='card-bd overflow-x-auto'><table className='table'><thead><tr><th>ID</th><th>SKU</th><th>Όνομα</th><th>Μονάδα</th><th>Stock</th><th>Τιμές A/B/C</th><th></th></tr></thead><tbody>{list.map((p:any)=>(<tr key={p.id}><td className='font-mono text-xs'>{p.id}</td><td className='font-mono text-xs'>{p.sku}</td><td>{p.name}</td><td>{p.unit}</td><td>{p.stock_qty}</td><td>{[p.priceA,p.priceB,p.priceC].map(x=>x!=null?x.toFixed(2):'—').join(' / ')}</td><td><button className='btn' onClick={()=>edit(p)}>Επεξεργασία</button></td></tr>))}</tbody></table></div></div></div>);}
